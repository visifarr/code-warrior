<!DOCTYPE html>
<html>
<head>
  <title>Code Warrior - Игра</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="game-container">
    <h1 id="problem">Реши пример: <span id="task">5 + 3 = ?</span></h1>
    <input type="number" id="answer">
    <button onclick="checkAnswer()">Проверить</button>
    <p>Монеты: <span id="coins">0</span></p>
    <a href="./lobby.html" class="shop-btn">Магазин</a> <!-- Исправленная ссылка! -->
  </div>

  <script>
    // Проверка авторизации
    const user = JSON.parse(localStorage.getItem('currentUser'));
    if (!user) {
      alert('Сначала зарегистрируйтесь!');
      window.location.href = 'index.html'; // Остаемся тут, т.к. это теперь index.html
    } else {
      document.getElementById('coins').textContent = user.coins || 0;
    }

    // Игровая логика
    let correctAnswer = generateProblem();
    
    function generateProblem() {
      const a = Math.floor(Math.random() * 10);
      const b = Math.floor(Math.random() * 10);
      document.getElementById('task').textContent = `${a} + ${b} = ?`;
      return a + b;
    }

    function checkAnswer() {
      const userAnswer = parseInt(document.getElementById('answer').value);
      if (userAnswer === correctAnswer) {
        user.coins += 10;
        localStorage.setItem('currentUser', JSON.stringify(user));
        document.getElementById('coins').textContent = user.coins;
        alert('Правильно! +10 монет.');
        correctAnswer = generateProblem();
      } else {
        alert('Ошибка!');
      }
    }
  </script>
</body>
</html>
